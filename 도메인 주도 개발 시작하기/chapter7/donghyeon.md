# 📘 도메인 주도 개발 시작하기 - 7장 정리

## 7.1 여러 애그리거트가 필요한 기능

- 하나의 애그리거트로 도메인 기능을 구현할 수 없을 때가 있다.
- 이 경우, 특정 애그리거트에 모든 기능을 구현하게 되면 **책임 범위를 침범**하게 되며, 이는 유지보수성과 도메인 캡슐화 측면에서 바람직하지 않다.
- 👉 이를 해결하는 방법으로 **도메인 기능을 별도 도메인 서비스로 분리**하여 구현할 수 있다.

---

## 7.2 도메인 서비스

- **도메인 서비스**는 다음과 같은 경우에 사용된다:
  1. 여러 애그리거트가 필요한 계산 로직
  2. 하나의 애그리거트에 넣기에는 복잡한 계산 로직
  3. 외부 시스템과 연동이 필요한 도메인 로직

---

### 7.2.1 계산 로직과 도메인 서비스

- 도메인 서비스는 일반적으로 **상태를 가지지 않는다.**
- 순수한 계산 로직을 처리하며, 상태가 필요할 경우 호출 시점에 파라미터로 전달받는다.
- 도메인 서비스를 사용하는 주체는:
  - 응용 서비스
  - 애그리거트 내부 (단, 해당 로직이 명확히 도메인 서비스의 책임일 경우)

---

### 7.2.2 외부 시스템 연동과 도메인 서비스

- 외부 시스템과의 연동(예: 결제 API, 배송 API 등)도 도메인 로직일 수 있다.
- 이 경우에도 **도메인 서비스**로 분리하여 해당 책임을 처리한다.
- 응용 서비스에서 직접 외부 연동을 처리하는 경우 도메인 로직과 기술 구현이 섞여버릴 수 있다.

---

### 7.2.3 도메인 서비스의 패키지 위치

- 도메인 서비스 클래스는 해당 **도메인 하위 패키지**에 위치시키는 것이 일반적이다.
- 만약 도메인 서비스가 많아질 경우, `service` 또는 역할별 하위 패키지로 나누어 관리해도 무방하다.

---

### 7.2.4 도메인 서비스의 인터페이스와 클래스

- 도메인 서비스가 외부 시스템이나 특정 구현 기술에 의존한다면, **인터페이스로 추상화**하고 구현체를 외부 인프라 레이어에서 제공하는 것이 좋다.
- 예: 결제 승인 서비스 → `PaymentService` 인터페이스는 도메인 영역에, 실제 구현은 인프라스트럭처 레이어에 위치
- 이로 인해 도메인 영역은 구현 기술에 대한 **의존을 제거**할 수 있고, 테스트 용이성과 유연성이 증가한다.

