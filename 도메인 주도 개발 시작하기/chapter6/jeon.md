# 응용 서비스와 표현 영역

## 표현 영역과 응용 영역
- 표현 영역
  - 사용자의 요청을 해석
- 응용 영역
  - 실제 사용자가 원하는 기능을 제공하는 서비스

## 응용 서비스의 역할
- 도메인 객체를 사용해서 사용자의 요청을 처리하는 것.
- 응용 서비스가 복잡하다면 도메인 로직의 일부를 구현하고 있을 가능성이 높다.
- 응용 서비스는 트랜잭션 처리도 담당.
  - 도메인의 상태 변경을 트랜잭션으로 처리해야 한다.

### 도메인 로직 넣지 않기
- 패스워드 변경 기능
  - member.changePassword(oldPw, newPw);
  - 여기서 호출하는 부분 제외, 검증 및 변경은 다 도메인로직에서 처리해야 함.
    - ex) 기존 암호를 올바르게 입력했는지 확인하는 것은 도메인의 핵심 로직이기 때문에..
- 도메인 로직을 도메인 영역과 응용 서비스에 분산해서 구현하면?
  - 코드 품질에 문제가 발생
    - 코드의 응집성이 떨어진다.
    - 여러 응용 서비스에서 동일한 도메인 로직을 구현할 가능성이 높아진다.
  - 이는 결과적으로 코드 변경을 어렵게 만든다.

## 응용 서비스의 구현
- 응용 서비스는 표현 영역과 도메인 영역을 연결하는 매개체 역할을 하는데, 이는 파사드(facade)와 같은 역할을 한다.

### 응용 서비스의 크기
- 한 응용 서비스 클래스에 회원 도메인의 모든 기능 구현하기
  - 동일 로직에 대한 코드 중복을 제거할 수 있는 장점.
  - 한 서비스 클래스의 크기가 커진다는 단점
    - 연관성이 적은 코드가 한 클래스에 함께 위치할 가능성이 높아져, 코드 이해에 방해
    - 습관적으로 기존에 존재하는 클래스에 억지로 끼워넣게 됨.
- 구분되는 기능별로 응용 서비스 클래스를 따로 구현하기
  - 중복해서 동일 코드를 구현할 가능성이 있지만 이는 별도 클래스에 로직을 구현해서 방지 가능.
    - XXXHelper
- 한 응용 서비스 클래스에서 한 개 내지 2~3개 기능을 구현.

### 응용 서비스의 인터페이스와 클래스
- 인터페이스가 명확하게 필요하지 않다면 굳이 인터페이스 안써도 됨.

### 메서드 파라미터와 값 리턴
- 파라미터로 변수 받거나 객체(XXXRequest) 받기
  - 요청 파라미터가 두 개 이상 존재하면 별도 클래스 사용하는게 편리.
- 애그리거트 리턴 X
  - 애그리거트 자체를 리턴하면 편리하기 하지만 도메인의 로직 실행을 응용 서비스와 표현 영역 두 곳에서 할 수 있게 된다.
  - 코드의 응집도를 낮추는 원인이 됨.
  - 응용 서비스는 표현 영역에서 필요한 데이터만 리턴하는 것이 기능 실행 로직의 응집도를 높이는 확실한 방법이다.

### 표현 영역에 의존하지 않기
- HttpServletRequest / HttpSession 같은 표현 영역에 해당하는 객체를 응용 서비스에 파라미터로 전달하면 안 된다.
  - 응용 서비스만 단독으로 테스트하기 어려워짐
  - 표현 영역의 역할까지 대신하는 상황이 벌어질 수 도 있음.
    - 표현 영역의 응집도가 깨짐
      - 결과적으로 코드 유지 보수 비용을 증가시키는 원인이 됨.
- 서비스 메서드의 파라미터와 리턴 타입으로 표현 영역의 구현 기술을 사용하지 않아야 함.

### 트랜잭션 처리
- 트랜잭션을 관리하는 것은 응용 서비스의 중요한 역할이다.

